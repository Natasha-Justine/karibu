{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Haribu Groceries Limited Dashboard</title>
    <link rel="stylesheet" href="{% static 'dash.css' %}">
    <link rel="stylesheet" href="{% static 'bootstrap-5.0.2-dist/css/bootstrap.css' %}">
    <style>
        body {
            display: flex;
            min-height: 100vh;
            flex-direction: column;
            overflow-x: hidden; /* Absolutely crucial for preventing horizontal page movement */
            margin: 0;
            padding: 0;
            position: relative;
            background-color: #ecf4f4;/* Light grey background for the body */
        }

        .sidebar {
            width: 250px;
            background-color: #9bf39b;
            color: black;
            padding-top: 20px;
            position: fixed;
            height: 100%;
            overflow-y: auto;
            z-index: 1000;
            left: 0;
            top: 0;
            bottom: 0;
        }

        .logo-container {
            padding: 20px;
        }

        .logo {
            display: flex;
            align-items: center;
        }

        .logo img {
            width: 40px;
            height: 40px;
            border-radius: 5px;
            margin-right: 10px;
        }

        .logo-text {
            line-height: 1.2;
            font-size: 1.1em;
        }

        .logo-text span {
            font-size: 0.8em;
            color: black;
        }

        .menu-item {
            display: flex;
            align-items: center;
            padding: 10px 20px;
            text-decoration: none;
            color:black;
            margin-bottom: 5px;
            transition: background-color 0.3s ease;
        }

        .menu-item:hover {
            background-color: #1b5e20;
        }

        .menu-item svg {
            width: 20px;
            height: 20px;
            margin-right: 10px;
            fill: black;
        }

        .dashboard-content {
            flex-grow: 1;
            margin-left: 250px;
            padding: 20px;
            padding-bottom: 100px; /* Increased space for footer */
            display: flex;
            flex-direction: column;
            align-items: flex-start; /* Ensures content aligns to the left and takes full width */
            width: calc(100% - 250px);
            min-height: calc(100vh - 60px);
        }

        .dashboard-content > div > h1 {
            text-align: center;
            margin-bottom: 20px;
            width: 100%; /* Ensures the heading centers within the full width */
        }

        .card-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            max-width: 960px;
            width: 100%;
            justify-content: flex-start; /* Aligns cards to the left, allowing wrapping */
        }

        .dashboard-card {
            background-color: rgb(213, 213, 213);
            border: 1px solid #ddd;
            padding: 40px;
            border-radius: 8px;
            width: calc(50% - 10px); /* Two cards per row with gap */
            box-sizing: border-box;
            margin-bottom: 20px;
            text-align: center;
        }

        .dashboard-card h3 {
            margin-top: 0;
            margin-bottom: 10px;
            color: #333;
        }

        .dashboard-card p {
            margin-bottom: 15px;
            color: #666;
            font-size: 1.1em;
        }

        .dashboard-card input[type="submit"] {
            padding: 8px 15px;
            border: none;
            border-radius: 5px;
            color: white;
            cursor: pointer;
            margin: 5px;
        }

        .dashboard-card input[value="view"] {
            background-color: #4CAF50;
        }

        footer {
            position: fixed;
            bottom: 0;
            left: 0px;
            right: 0;
            background-color: #6c6d6e;
            border-top: 1px solid #817f7f;
            padding: 10px;
            text-align: center;
            font-size: 0.9em;
            color: #f8f2f2;
            z-index: 999;
            margin-left: 250px; /* Ensures footer is visible next to fixed sidebar */
        }

        @media (max-width: 768px) {
            body {
                flex-direction: column;
                background-color: #e2e3e3;
                overflow-x: hidden;
            }
            .sidebar {
                width: 100%;
                position: fixed;
                top: 0;
                height: auto;
                overflow-x: auto;
                display: flex;
                z-index: 1000;
            }
            .logo-container {
                display: none;
            }
            .menu-item {
                flex-shrink: 0;
                width: auto;
                padding: 10px 15px;
                margin-right: 5px;
                border-bottom: none;
            }
            .dashboard-content {
                margin-left: 0;
                padding-top: 90px; /* Adjust for top sidebar */
                align-items: stretch;
                width: 100%;
                padding: 20px;
                padding-bottom: 120px;
            }
            .dashboard-content > div > h1 {
                width: 100%;
            }
            .card-container {
                justify-content: center;
            }
            .dashboard-card {
                width: calc(50% - 20px);
            }
            footer {
                left: 0;
                position: fixed;
                margin-left: 0; /* Full width footer on smaller screens */
            }
        }

        @media (max-width: 576px) {
            .dashboard-card {
                width: 100%;
            }
            .menu-item span {
                display: none;
            }
            .menu-item svg {
                margin-right: 0;
            }
        }
    </style>
</head>
<body>
    <div class="sidebar">
        <div class="logo-container">
            <div class="logo">
                <img src="{% static 'log.jpg' %}" alt="Karibu Groceries Logo">
                <div class="logo-text">
                    KARIBU<br>
                    <span>Groceries limited</span>
                </div>
            </div>
        </div>

        <a href="#" class="menu-item active">
            <svg viewBox="0 0 24 24">
                <path fill="currentColor" d="M3,13H9V7H3M3,21H9V15H3M11,21H17V11H11M11,3V9H21V3"/>
            </svg>
            <span>Dashboard</span>
        </a><br>

        <a href="/allsales/" class="menu-item">
            <svg viewBox="0 0 24 24">
                <path fill="currentColor" d="M12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12A4,4 0 0,1 8,8A4,4 0 0,1 12,4M12,14C16.42,14 20,15.79 20,18V20H4V18C4,15.79 7.58,14 12,14Z"/>
            </svg>
            <span>Allsales</span>
        </a><br>


        <a href="/allstock/" class="menu-item">
            <svg viewBox="0 0 24 24">
                <path fill="currentColor" d="M12,16A3,3 0 0,1 9,13A3,3 0 0,1 12,10A3,3 0 0,1 15,13A3,3 0 0,1 12,16M12,6A2,2 0 0,1 14,8A2,2 0 0,1 12,10A2,2 0 0,1 10,8A2,2 0 0,1 12,6M12,18C16.42,18 20,19.27 20,21V22H4V21C4,19.27 7.58,18 12,18Z"/>
            </svg>
            <span>Allstock</span>
        </a><br>

        <a href="/credit/" class="menu-item">
            <svg viewBox="0 0 24 24">
                <path fill="currentColor" d="M5,5H19V7H5M5,11H19V13H5M5,17H15V19H5M17,17V19L20,18L17,17Z"/>
            </svg>
            <span>All credits</span>
        </a><br>

        <a href="/receipt/" class="menu-item">
            <svg viewBox="0 0 24 24">
                <path fill="currentColor" d="M11,17H13V15H11V17M11,13H13V7H11V13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"/>
            </svg>
            <span>All receipts</span>
        </a><br>

        {% if user.is_authenticated %}
        <form action="{% url 'logout' %}" method="POST">
            {% csrf_token %}
            <button type="submit" class="menu-item" style="background: none; border: none; color: black; cursor: pointer; padding: 10px 20px; margin-bottom: 5px; display: flex; align-items: center; text-decoration: none;">
                <svg viewBox="0 0 24 24" style="width: 20px; height: 20px; margin-right: 10px; fill: black;">
                    <path fill="currentColor" d="M12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12A4,4 0 0,1 8,8A4,4 0 0,1 12,4M12,14C16.42,14 20,15.79 20,18V20H4V18C4,15.79 7.58,14 12,14Z"/>
                </svg>
                <span>Logout</span>
            </button>
        </form>
        {% endif %}

    </div>

    <div class="dashboard-content">
        <div>
            <h1 style="color:#333">SalesAgent Dashboard</h1>
        </div>
        <div class="card-container">
            <div class="dashboard-card">
                <h3>Total Sales</h3>
                <p>UGX {{ total_sales| floatformat:0 }}</p><br>

                <a href="/allsales/"><input type="submit" value="view"></a>

            </div>

            <div class="dashboard-card">
                <h3>TOTAL Stock</h3>
                <p>kgs {{ total_stock}}</p><br>

                <a href="/allstock/"><input type="submit" value="view"></a>

            </div>


            <div class="dashboard-card">
                <h3>Total Credits</h3>
                <p>UGX {{ total_credit_sales| floatformat:0 }}</p><br>

                <a href="/credit/"><input type="submit" value="view"></a>

            </div>

            <div class="dashboard-card">
                <h3>All Receipts</h3>
                <p></p><br>

                <a href="/receipt/"><input type="submit" value="view"></a>

            </div>
        </div>
    </div>

    <footer>
        <p>&copy; 2025 Karibu Grocery Limited.Designed by Justine Natasha.</p>
        <p>Your Trusted Source for Quality Groceries in Uganda.</p>
    </footer>

    <script src="{% static 'bootstrap-5.0.2-dist/js/bootstrap.bundle.js' %}"></script>
</body>
</html>